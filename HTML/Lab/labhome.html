<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lab Technician Dashboard</title>

  <!-- Bootstrap CSS -->
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" /> -->
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/CSS/lab.css" />
</head>
<body>

  <!-- Page Title -->
  <h1 align="center" class="my-4">Laboratory Management System</h1>

  <!-- Top Contact Bar -->
  <div class="bg-white border-bottom py-2 small">
    <div class="container d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center gap-4">
        <span><strong>Customer Care:</strong> 9700 36 9700</span>
        <i class="bi bi-person-circle fs-5"></i>
        <i class="bi bi-cart fs-5"></i>
      </div>
    </div>
  </div>

  <!-- Navigation Bar -->
  <nav class="bg-purple text-white py-3">
    <div class="container d-flex justify-content-around">
      <a href="labhome.html" class="nav-link text-white fw-bold">Home</a>
      <a href="availabletest.html" class="nav-link text-white">Available Tests</a>
      <a href="createreport.html" class="nav-link text-white">Create Report</a>
      <a href="viewreport.html" class="nav-link text-white">View Reports</a>
      <!-- <a href="#" class="nav-link text-white">Contact Us</a> -->
      <!-- User Icon Dropdown -->
      <div class="user-menu" style="position:relative;">
        <button id="userIconBtn" style="background:none;border:none;cursor:pointer;outline:none;">
          <svg width="28" height="28" fill="#fff" viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M12 14c-4.418 0-8 1.79-8 4v2h16v-2c0-2.21-3.582-4-8-4z"/></svg>
        </button>
        <div id="userDropdown" class="user-dropdown" style="display:none;position:absolute;right:0;top:36px;background:#fff;color:#003087;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.12);min-width:180px;z-index:10;">
          <button class="dropdown-item" onclick="logout()" style="width:100%;background:none;border:none;padding:12px 18px;text-align:left;cursor:pointer;font-size:1rem;">Logout</button>
          <button class="dropdown-item" onclick="showChangePassword()" style="width:100%;background:none;border:none;padding:12px 18px;text-align:left;cursor:pointer;font-size:1rem;">Change Password</button>
        </div>
      </div>
    </div>
  </nav>

    <br> <br>
    <h2 align="center">Welcome to the Dashboard</h2>
    <div id="labOrdersSection" style="max-width:900px;margin:32px auto 0 auto;"></div>
  <!-- Change Password Modal -->
  <div id="changePasswordModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);z-index:1000;align-items:center;justify-content:center;">
    <div style="background:#fff;padding:2rem 2.5rem;border-radius:10px;max-width:350px;width:90%;box-shadow:0 4px 24px rgba(0,0,0,0.18);position:relative;">
      <h3 style="color:#003087;margin-bottom:1.2rem;font-size:1.2rem;">Change Password</h3>
      <form id="changePasswordForm">
        <label style="font-size:0.98rem;">Current Password<br><input type="password" id="currentPassword" style="width:100%;margin-bottom:0.7rem;padding:0.6rem;border:1px solid #ccc;border-radius:5px;"></label><br>
        <label style="font-size:0.98rem;">New Password<br><input type="password" id="newPassword" style="width:100%;margin-bottom:0.7rem;padding:0.6rem;border:1px solid #ccc;border-radius:5px;"></label><br>
        <label style="font-size:0.98rem;">Confirm New Password<br><input type="password" id="confirmPassword" style="width:100%;margin-bottom:1.1rem;padding:0.6rem;border:1px solid #ccc;border-radius:5px;"></label><br>
        <button type="submit" style="background:#003087;color:#fff;padding:0.7rem 1.2rem;border:none;border-radius:6px;font-size:1rem;cursor:pointer;width:100%;">Save</button>
        <button type="button" onclick="closeChangePassword()" style="margin-top:0.7rem;background:#eee;color:#003087;padding:0.6rem 1.2rem;border:none;border-radius:6px;font-size:1rem;cursor:pointer;width:100%;">Cancel</button>
        <div id="changePasswordMsg" style="margin-top:0.7rem;font-size:0.98rem;"></div>
      </form>
    </div>
  </div>
  <script>
            function logout() {
                localStorage.removeItem("loggedInUser");
                localStorage.removeItem("sessionStart");

                // Prevent back navigation to dashboard
                history.pushState(null, null, location.href);
                window.addEventListener("popstate", function () {
                    history.pushState(null, null, location.href);
                });

                alert("You have been logged out.");
                window.location.href = "/HTML/Admin/admin_login.html";
            }
        </script>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
// User icon dropdown logic
const userIconBtn = document.getElementById('userIconBtn');
const userDropdown = document.getElementById('userDropdown');
userIconBtn.onclick = function(e) {
  e.stopPropagation();
  userDropdown.style.display = userDropdown.style.display === 'block' ? 'none' : 'block';
};
document.body.addEventListener('click', function() {
  userDropdown.style.display = 'none';
});
userDropdown.onclick = function(e) { e.stopPropagation(); };

// Change Password Modal logic
function showChangePassword() {
  document.getElementById('changePasswordModal').style.display = 'flex';
  document.getElementById('changePasswordMsg').textContent = '';
  document.getElementById('changePasswordForm').reset();
}
function closeChangePassword() {
  document.getElementById('changePasswordModal').style.display = 'none';
}
document.getElementById('changePasswordForm').onsubmit = function(e) {
  e.preventDefault();
  const current = document.getElementById('currentPassword').value;
  const newPass = document.getElementById('newPassword').value;
  const confirm = document.getElementById('confirmPassword').value;
  const loggedIn = JSON.parse(localStorage.getItem('loggedInUser'));
  const userKey = 'user_' + loggedIn.username;
  const userObj = JSON.parse(localStorage.getItem(userKey));
  const msgDiv = document.getElementById('changePasswordMsg');
  if (!current || !newPass || !confirm) {
    msgDiv.textContent = 'All fields are required.';
    msgDiv.style.color = '#dc3545';
    return;
  }
  if (userObj.password !== current) {
    msgDiv.textContent = 'Current password is incorrect.';
    msgDiv.style.color = '#dc3545';
    return;
  }
  if (newPass.length < 6) {
    msgDiv.textContent = 'New password must be at least 6 characters.';
    msgDiv.style.color = '#dc3545';
    return;
  }
  if (newPass !== confirm) {
    msgDiv.textContent = 'New passwords do not match.';
    msgDiv.style.color = '#dc3545';
    return;
  }
  userObj.password = newPass;
  localStorage.setItem(userKey, JSON.stringify(userObj));
  msgDiv.textContent = 'Password changed successfully!';
  msgDiv.style.color = '#28a745';
  setTimeout(closeChangePassword, 1200);
};
</script>
<script src="/JS/labhome.js"></script>
</body>
</html>


